# 爱奇艺ZoomAI视频增强技术应用

> 内容整理自[详解爱奇艺ZoomAI视频技术增强技术的应用](https://zhuanlan.zhihu.com/p/62735801)

## 视频/图像增强技术的重要性及现状

- 超高清时代

	- 用户行为不可控
	- 转播过程中的多次压缩
- 拍摄器材和技能受限
- 低质资源的问题
  - 胶片本身或数字化带来的噪点、划痕等损伤
  - 用户主动选择低码率产生的压缩噪声

## 视频/图像增强技术原理及面临的挑战

![多种原因导致的多种问题](https://pic1.zhimg.com/80/v2-3e07cfb5cc0496f158097c3760388e90_hd.jpg)

-------------

![超分辨率主要问题](https://pic1.zhimg.com/80/v2-b26b566339c5e43b68f845d76c46f54c_hd.jpg)

### 面临的主要问题

- CNN结构设计
- Loss函数选择使得图像细节或者边缘更清晰

### 主流的做法

#### 单针超分

![单针超分典型结构](https://pic3.zhimg.com/80/v2-7708243e8e96c9d8f21f08ee4336b66a_hd.jpg)

#### 多帧超分

![多帧超分](https://pic2.zhimg.com/80/v2-207685d47f77178facfe4573ed1f3a51_hd.jpg)

#### ZoomAI模型设计

![ZoomAI](https://pic3.zhimg.com/80/v2-94c0fc2d1054fa4e22aec1e18f2ecfee_hd.jpg)

- 一般的业务场景只需要扩大两倍，故采取单词上采用
- 借鉴DBPN思想采用DenseNet结构，该结构引入更多底层特征，全局残差
- loss函数选择：L1/L2 + 梯度Loss
  - L1、L2：模糊
  - GAN：语义不符；放大噪声
  - mse + 梯度loss： 目的是使边缘更锐利

-----------

![超分辨率在移动端的设计](https://pic2.zhimg.com/80/v2-a25dd1d10ec49214af86ab03a12a63f9_hd.jpg)

------

## 去噪问题

![去躁问题描述](https://pic2.zhimg.com/80/v2-22983926e194cef9512b416d4fcf6391_hd.jpg)

-----------------

![去躁网络的主要问题](https://pic3.zhimg.com/80/v2-59ffe2a0cb39f62e49e80f6bd0ea7a02_hd.jpg)

### 去躁问题的经典网络

![去躁经典网络](https://pic1.zhimg.com/80/v2-80bb15b880f608ab49c9670d6ae768dc_hd.jpg)

- DCNN:在训练集里加入多个层次的高斯去躁，模拟真实环境下的噪声
- CBDNet：网络分为两个部分：(1)估计噪声水平输入到第二个网络中；（2）不对称loss，估计不准确的情况下，往大估计或往小估计哪个更准确。

------------------------

### 去锐化效果

![去锐化整体效果](https://pic4.zhimg.com/v2-c99e76c3c1f7b3baf9e6b8245579b19b_r.jpg)



-------------

## 色彩增强

## 去划痕

## 插帧效果

## Q & A

1. **去噪的训练数据是如何构造的？怎么模拟真实噪声？模型是实时处理吗？**

   现在的去噪模型不是实时的，但可以实时，实时的话就需要把网络做得更简化。怎么模拟真实噪声？真实噪声是这样的，其实可以看一个香港理工大学的PolyU数据集，这是一个真实噪声的数据集，它是通过一个固定的照相机对一个场景多次狂拍，狂拍了以后每一帧都有噪声，然后再取个平均以后就觉得那是真实图片，我们的数据集一方面是用了这个，另外一方面是自己加入了不同的高斯噪声和压缩噪声尝试。

2. **去噪的时候如何同时训练去噪和锐化？**

   在数据集上设计加入不同比例的噪声和高斯模糊。

3. **去噪是一个模型吗？还是不同的噪声有不同的模型？**

   这里我们现在做的是有多个模型的，其实前置会有一个判断，会根据噪声的判断来决定采用不同配比的模型。

